# Язык формул 
В схеме [поисковой формы](common-format.md) можно встретить поля, имеющие атрибут `attr`. Это означает, что условия для поиска по данному атрибуту следует задавать, используя внутренний язык формул. Он вам может напомнить DSL, но имеет свои особенности.

```json
{
    "fieldName": "syntax",
    "showByDefault": true,
    "hasHelpText": true,
    "attr": {
        "name": "syntax",
        "level": "ATTR_LEVEL_WORD"
    }
}
```

**Процесс формирования формулы состоит из двух этапов.**

Примеры приведены на основе поискового поля «Синтаксические свойства слова» (`syntax`).

1. **Получение схемы значений атрибуты**
    Для это обратитесь к маршруту:

    ```bash
    curl -X 'GET' 'https://ruscorpora.ru/api/v1/attrs/syntax?corpus={"type":"MAIN"}' \
    -H 'Authorization: Bearer ***'
    ```

    ```json
    {
    "vals":[
        {
        "valOptions":{
            "v":{
            "title":"syntax",
            "options":[
                {
                "title":"Тип клаузы",
                "suboptions":{
                    "options":[
                    {
                        "title":"главная клауза",
                        "value":"clause_main"
                    },
                    {
                        "title":"подчиненная клауза",
                        "value":"clause_subj"
                    },
                    {
                        "title":"клауза с эллипсисом",
                        "value":"ellipsis"
                    },
                    {
                        "title":"глагольная клауза",
                        "value":"clause_v"
                    },
                    {
                        "title":"именная клауза",
                        "value":"clause_nom"
                    },
                    {
                        "title":"предикативная клауза",
                        "value":"predicative"
                    },
                    {
                        "title":"распространенный причастный оборот",
                        "value":"partp"
                    },
                    {
                        "title":"деепричастный оборот",
                        "value":"gerp"
                    }
                    ],
                    "combine":"COMBINE_OR"
                }
                },
                {
                "title":"Другие свойства вершины / зависимого",
                "suboptions":{
                    "options":[
                    {
                        "title":"вершина предложения",
                        "value":"root"
                    },
                    {
                        "title":"есть зависимые",
                        "value":"has_dep"
                    }
                    ],
                    "combine":"COMBINE_OR"
                }
                }
            ],
            "combine":"COMBINE_AND"
            }
        }
        }
    ]
    }
    ```

    Каждая группа содержит:
    - options: варианты значений, может быть рекурсивно вложен, но не более 5 уровней;
    - combine (правило объединения: COMBINE_AND или COMBINE_OR).
    Это схема описывает список допустимых значений и то, как они должны комбинироваться.


2. **Формирование выражения (формулы)**
    Для объединения значений используются логические операторы:
    - `|` (ИЛИ) соответствует COMBINE_OR,
    - `&` (И) соответствует COMBINE_AND.
    
    **Правила**:
    - если в схеме родительский узел имеет значение (value), если можно использовать вместо всех вложенных в него значений;
    - правило объедения по *COMBINE_AND* носит скорее рекомендательный характер, при составлении формул вы можете ставить эксперименты, если считаете, что под ваш запрос найдутся примеры:
      - `clause_main & clause_subj` синтаксически корректное, но невозможное выражение. Главная и подчиненная клауза не могут быть одной и той же единицей в предложении;
      - `ellipsis & clause_v` а вот клаза с эллипсом и глагольная вполне могут быть одной и той же единицей в предложении. Это может быть полезно для формирования более сложных запросов.
      *При формировании выражений опирайтесь на свой опыт и здравый смысл.*
    -  несколько значений можно взять в скобки, объединив в логические группы. Например, `(clause_main | clause_v) & has_dep` — вернёт примеры, которые находятся в главной или глагольной клаузе и имеют зависимые слова.


{% note info %}

Для более простых сценариев вы можете воспользоваться [инструментами интерфейса](index.md#ui-build-query), скопировав запрос целиком или только значение нужного атрибута.

{% endnote %}
